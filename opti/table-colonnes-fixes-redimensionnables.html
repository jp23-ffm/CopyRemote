<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Table Fixe et Redimensionnable</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        .table-container {
            overflow-x: auto;
            position: relative;
            max-width: 100%;
            border: 1px solid #ddd;
        }

        table {
            /* CHANGEMENT 1 : Mode fixe pour indépendance des colonnes */
            table-layout: fixed; 
            border-collapse: separate;
            border-spacing: 0;
            /* Le tableau doit pouvoir dépasser 100% si on agrandit les colonnes */
            width: max-content; 
            min-width: 100%;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            white-space: nowrap;
            position: relative;
            /* CHANGEMENT 2 : Une largeur par défaut est nécessaire en mode fixed */
            width: 150px; 
            box-sizing: border-box; /* Important pour inclure le padding dans la largeur */
        }
        
        /* Exception pour les colonnes ID souvent plus petites */
        th:first-child, td:first-child {
            width: 50px;
        }

        th {
            background-color: #f4f4f4;
            font-weight: bold;
            user-select: none;
        }

        tr:hover td {
            background-color: #f9f9f9;
        }

        th .resizer {
            position: absolute;
            top: 0;
            right: 0;
            width: 5px;
            height: 100%;
            cursor: col-resize;
            background: transparent;
            z-index: 10;
        }

        th .resizer:hover {
            background: #4CAF50;
        }

        th .resizer.resizing {
            background: #2196F3;
        }
    </style>
</head>
<body>
    <h1>Table avec colonnes indépendantes</h1>
    <p>Le redimensionnement d'une colonne ne déforme plus les autres.</p>

    <div class="table-container">
        <table id="myTable">
            <thead>
                <tr>
                    <th>ID<span class="resizer"></span></th>
                    <th>Nom<span class="resizer"></span></th>
                    <th>Prénom<span class="resizer"></span></th>
                    <th>Email<span class="resizer"></span></th>
                    <th>Téléphone<span class="resizer"></span></th>
                    <th>Adresse<span class="resizer"></span></th>
                    <th>Ville<span class="resizer"></span></th>
                    <th>Code Postal<span class="resizer"></span></th>
                    <th>Pays<span class="resizer"></span></th>
                    <th>Département<span class="resizer"></span></th>
                    <th>Date de naissance<span class="resizer"></span></th>
                    <th>Profession<span class="resizer"></span></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>Dupont</td>
                    <td>Jean</td>
                    <td>jean.dupont@example.com</td>
                    <td>06 12 34 56 78</td>
                    <td>15 rue de la Paix</td>
                    <td>Paris</td>
                    <td>75001</td>
                    <td>France</td>
                    <td>Paris</td>
                    <td>15/03/1985</td>
                    <td>Développeur</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Martin</td>
                    <td>Sophie</td>
                    <td>sophie.martin@example.com</td>
                    <td>06 98 76 54 32</td>
                    <td>28 avenue des Champs</td>
                    <td>Lyon</td>
                    <td>69001</td>
                    <td>France</td>
                    <td>Rhône</td>
                    <td>22/07/1990</td>
                    <td>Designer</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Bernard</td>
                    <td>Pierre</td>
                    <td>pierre.bernard@example.com</td>
                    <td>06 11 22 33 44</td>
                    <td>5 boulevard Victor Hugo</td>
                    <td>Marseille</td>
                    <td>13001</td>
                    <td>France</td>
                    <td>Bouches-du-Rhône</td>
                    <td>10/11/1982</td>
                    <td>Chef de projet</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Dubois</td>
                    <td>Marie</td>
                    <td>marie.dubois@example.com</td>
                    <td>06 55 66 77 88</td>
                    <td>42 rue du Commerce</td>
                    <td>Toulouse</td>
                    <td>31000</td>
                    <td>France</td>
                    <td>Haute-Garonne</td>
                    <td>05/09/1988</td>
                    <td>Consultante</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>Moreau</td>
                    <td>Lucas</td>
                    <td>lucas.moreau@example.com</td>
                    <td>06 99 88 77 66</td>
                    <td>18 place de la République</td>
                    <td>Nice</td>
                    <td>06000</td>
                    <td>France</td>
                    <td>Alpes-Maritimes</td>
                    <td>30/12/1992</td>
                    <td>Architecte</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>Petit</td>
                    <td>Emma</td>
                    <td>emma.petit@example.com</td>
                    <td>06 44 33 22 11</td>
                    <td>7 allée des Roses</td>
                    <td>Nantes</td>
                    <td>44000</td>
                    <td>France</td>
                    <td>Loire-Atlantique</td>
                    <td>18/04/1995</td>
                    <td>Ingénieure</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>Roux</td>
                    <td>Thomas</td>
                    <td>thomas.roux@example.com</td>
                    <td>06 77 88 99 00</td>
                    <td>33 cours Lafayette</td>
                    <td>Bordeaux</td>
                    <td>33000</td>
                    <td>France</td>
                    <td>Gironde</td>
                    <td>12/06/1987</td>
                    <td>Manager</td>
                </tr>
                <tr>
                    <td>8</td>
                    <td>Laurent</td>
                    <td>Chloé</td>
                    <td>chloe.laurent@example.com</td>
                    <td>06 22 33 44 55</td>
                    <td>9 rue Pasteur</td>
                    <td>Strasbourg</td>
                    <td>67000</td>
                    <td>France</td>
                    <td>Bas-Rhin</td>
                    <td>25/01/1991</td>
                    <td>Médecin</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        const table = document.getElementById('myTable');
        
        function fixColumns() {
            const rows = table.querySelectorAll('tr');
            
            rows.forEach(row => {
                const cells = row.children;
                let cumulativeWidth = 0;
                
                // On fixe toujours les 3 premières colonnes
                for (let i = 0; i < 3 && i < cells.length; i++) {
                    const cell = cells[i];
                    cell.style.position = 'sticky';
                    cell.style.left = cumulativeWidth + 'px';
                    cell.style.backgroundColor = row.parentElement.tagName === 'THEAD' ? '#f4f4f4' : 'white';
                    cell.style.zIndex = row.parentElement.tagName === 'THEAD' ? '3' : '2';
                    
                    if (i === 2) {
                        cell.style.boxShadow = '2px 0 5px rgba(0,0,0,0.1)';
                    }
                    
                    // offsetWidth fonctionne toujours correctement même en table-layout: fixed
                    cumulativeWidth += cell.offsetWidth;
                }
            });
        }

        const resizers = document.querySelectorAll('.resizer');
        let currentResizer = null;
        let currentTh = null;
        let startX = 0;
        let startWidth = 0;

        resizers.forEach(resizer => {
            resizer.addEventListener('mousedown', (e) => {
                currentResizer = resizer;
                currentTh = resizer.parentElement;
                startX = e.pageX;
                startWidth = currentTh.offsetWidth;
                
                currentResizer.classList.add('resizing');
                document.body.style.userSelect = 'none';
                e.preventDefault();
            });
        });

        document.addEventListener('mousemove', (e) => {
            if (currentResizer) {
                const diff = e.pageX - startX;
                const newWidth = startWidth + diff;
                
                if (newWidth >= 50) {
                    // CHANGEMENT 3 : Plus besoin de boucler sur toutes les lignes !
                    // En table-layout: fixed, changer le header suffit.
                    currentTh.style.width = newWidth + 'px';
                    
                    // On appelle fixColumns car si on redimensionne une des 3 premières colonnes,
                    // les positions 'sticky' des suivantes doivent bouger.
                    fixColumns();
                }
            }
        });

        document.addEventListener('mouseup', () => {
            if (currentResizer) {
                currentResizer.classList.remove('resizing');
                currentResizer = null;
                currentTh = null;
                document.body.style.userSelect = '';
            }
        });

        window.addEventListener('load', fixColumns);
        window.addEventListener('resize', fixColumns);
    </script>
</body>
</html>