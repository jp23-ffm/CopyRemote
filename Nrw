# Ton queryset actuel
queryset = Server.objects.only(*fields_to_fetch).filter(
    Q(LIVE_STATUS='ALIVE') & Q(SNOW_STATUS='OPERATIONAL')
).order_by('SERVER_ID')

# Analyse normale...
for server in queryset.iterator(chunk_size=50000):
    # ... ton code existant ...

# Puis cherche les incoh√©rences
inconsistent_servers = Server.objects.only('SERVER_ID', 'LIVE_STATUS', 'SNOW_STATUS').filter(
    Q(LIVE_STATUS='ALIVE') & ~Q(SNOW_STATUS='OPERATIONAL')
)

for server in inconsistent_servers:
    server_id = server.SERVER_ID
    
    if server_id not in server_data:
        server_data[server_id] = {
            'missing_fields': {'LIVE_STATUS_SNOW_STATUS_INCONSISTENT'},
            'field_values': {}
        }
    else:
        server_data[server_id]['missing_fields'].add('LIVE_STATUS_SNOW_STATUS_INCONSISTENT')
    
    server_data[server_id]['field_values']['live_status_snow_status_ok'] = False
