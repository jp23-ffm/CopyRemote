python manage.py shell



# Importer tes modèles
from ton_app.models import CustomUser, UserProfile, SavedSearch, SavedOptions, UserPermissions, SavedChart

# Récupérer un user
user = CustomUser.objects.first()

# Accéder au UserProfile (pas de related_name défini, donc c'est 'userprofile')
user.userprofile
user.userprofile.email_address

# Accéder aux SavedSearch liés à ce UserProfile
user.userprofile.savedsearch_set.all()

# Accéder aux SavedOptions
user.userprofile.savedoptions_set.all()

# Accéder aux UserPermissions
user.userprofile.userpermissions_set.all()

# Accéder aux SavedChart (attention: related_name="saved_charts")
user.userprofile.saved_charts.all()

# Voir tous les champs du user
user.__dict__

# Tester si le profile existe
try:
    profile = user.userprofile
    print(f"Profile trouvé: {profile.email_address}")
except UserProfile.DoesNotExist:
    print("Pas de profile pour cet user")

-----------

# Importer tes modèles
from ton_app.models import CustomUser, UserProfile, UserPermissions

# Prendre un user spécifique (celui avec index 10 par exemple)
user = CustomUser.objects.get(id=10)
print(f"CustomUser ID: {user.id}")

# Vérifier le UserProfile
profile = user.userprofile
print(f"UserProfile ID: {profile.id}")
print(f"UserProfile.user_id (FK vers CustomUser): {profile.user_id}")

# Chercher les permissions liées à CE profile
permissions = UserPermissions.objects.filter(user_profile=profile)
print(f"Nombre de permissions trouvées: {permissions.count()}")

# Voir TOUTES les permissions pour débugger
all_perms = UserPermissions.objects.all()
for perm in all_perms:
    print(f"Permission ID: {perm.id}, user_profile_id: {perm.user_profile_id}")

# Vérifier s'il y a une permission avec user_profile_id=10
perm_10 = UserPermissions.objects.filter(user_profile_id=10)
print(f"Permissions avec user_profile_id=10: {perm_10.count()}")
